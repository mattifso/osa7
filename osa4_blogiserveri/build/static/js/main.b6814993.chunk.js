(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{171:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(37),o=n.n(l),c=n(15),u=n(8),i=n.n(u),s=n(11),d=n(30),m=n(20),p=n(16),f=n(22),h=n(21),g=n(23),b=n(53),v=n(52),E=function(e){return"/blogs/"+e._id},O=function(e){var t=e.blog;return r.a.createElement("div",null,r.a.createElement("a",{href:E(t)},t.title," ",t.author))},y=n(59),j=n(83),w=n(26),C=n.n(w),I="/api/blogs",k=null,S={getAll:function(){return C.a.get(I).then(function(e){return e.data})},setToken:function(e){k="Bearer ".concat(e)},create:function(){var e=Object(s.a)(i.a.mark(function e(t){var n,a,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:k}},e.prev=1,e.next=4,C.a.post(I,t,n);case 4:return a=e.sent,r=a.data,e.abrupt("return",r);case 9:e.prev=9,e.t0=e.catch(1),console.log("error occurred",e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(s.a)(i.a.mark(function e(t,n){var a,r,l;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:k}},e.prev=1,r=[I,"/",t,"/","comments"].join(""),e.next=5,C.a.post(r,{comment:n},a);case 5:return l=e.sent,e.abrupt("return",l.data);case 9:e.prev=9,e.t0=e.catch(1),console.log("error occurred",e.t0);case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,n){return e.apply(this,arguments)}}()},A=function(e,t){return function(n){n({type:"NOTIFICATION",data:{isError:e,message:t}}),setTimeout(function(){n({type:"CLEAR_NOTIFICATION"})},5e3)}},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"NOTIFICATION"===t.type?t.data:"CLEAR_NOTIFICATION"===t.type?null:e},B=function(){return function(){var e=Object(s.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},U=function(e,t){return function(){var n=Object(s.a)(i.a.mark(function n(a){var r;return i.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,S.addComment(e,t);case 2:r=n.sent,console.log("Added comment for blog",e,r,t),a({type:"ADD_COMMENT",data:{blogId:e,comment:t}});case 5:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if("INIT_BLOGS"===t.type&&Array.isArray(t.data))return t.data;if("ADD_COMMENT"===t.type&&!Array.isArray(t.data)&&void 0===t.data._id){var n=t.data.blogId,a=t.data.comment;return e.map(function(e){return e._id!==n?e:Object(j.a)({},e,{comments:Object(y.a)(e.comments).concat([a])})})}return"ADD_BLOG"!==t.type||Array.isArray(t.data)||void 0!==t.data.comment?e:Object(y.a)(e).concat([t.data])},D=n(172),L=n(173),T=n(179),N=n(174),F=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).createBlogEntry=function(){return function(){var e=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n.props.addBlog({title:n.state.title,author:n.state.author,url:n.state.url});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},n.handleAddBlogFieldChange=function(e){n.setState(Object(d.a)({},e.target.name,e.target.value))},n.state={title:"",author:"",url:""},n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,"create new"),r.a.createElement("form",{onSubmit:this.createBlogEntry},r.a.createElement(D.a,{style:{width:"25em"}},r.a.createElement("p",null,r.a.createElement(L.a,null,"title"),r.a.createElement(T.a,{name:"title",type:"text",value:this.state.title,onChange:this.handleAddBlogFieldChange})),r.a.createElement("p",null,r.a.createElement(L.a,null,"author"),r.a.createElement(T.a,{name:"author",type:"text",value:this.state.author,onChange:this.handleAddBlogFieldChange})),r.a.createElement("p",null,r.a.createElement(L.a,null,"url"),r.a.createElement(T.a,{name:"url",type:"text",value:this.state.url,onChange:this.handleAddBlogFieldChange}),r.a.createElement(N.a,{bsStyle:"success",onClick:this.createBlogEntry()},"create")))))}}]),t}(r.a.Component),G={addBlog:function(e){return function(){var t=Object(s.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.create(e);case 2:(a=t.sent)&&(n({type:"ADD_BLOG",data:a}),A(!1,'Added blog "'.concat(a.title,'"'))(n));case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},M=Object(c.b)(function(e){return{blogs:e.blogs}},G)(F),R=function(e){var t=e.handleSubmit,n=e.handleChange,a=e.username,l=e.password;return r.a.createElement("div",null,r.a.createElement("h2",null,"Log in to application"),r.a.createElement("form",{onSubmit:t},r.a.createElement(D.a,{style:{width:"25em"}},r.a.createElement("div",null,r.a.createElement(L.a,null,"username"),r.a.createElement(T.a,{name:"username",type:"text",value:a,onChange:n})),r.a.createElement("div",null,r.a.createElement(L.a,null,"password"),r.a.createElement(T.a,{name:"password",type:"password",value:l,onChange:n})),r.a.createElement(N.a,{bsStyle:"success",type:"submit"},"kirjaudu"))))},J=function(){return C.a.get("/api/users").then(function(e){return e.data})},V=function(){return function(){var e=Object(s.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"INIT_USERS"===t.type?t.data:e},H=n(175),W=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.initUsers()}},{key:"getLink",value:function(e){return"/users/"+e.id}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(H.a,null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"Blogs added")),this.props.users.map(function(t){return r.a.createElement("tr",{key:t.id},r.a.createElement("td",null,r.a.createElement("a",{href:e.getLink(t)},t.name)),r.a.createElement("td",null,t.blogs.length))}))))}}]),t}(r.a.Component),q={initUsers:V},K=Object(c.b)(function(e){return{users:e.users}},q)(W),P=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={userId:e.userId},n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.initUsers()}}]),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.users.find(function(t){return t.id===e.props.userId}),n=t?t.blogs:[];return r.a.createElement("div",null,r.a.createElement("h2",null,t?t.name:""),r.a.createElement("h3",null,"Added blogs"),r.a.createElement("ul",null,n.map(function(e){return r.a.createElement("li",{key:e._id},e.title)})))}}]),t}(r.a.Component),Q={initUsers:V},X=Object(c.b)(function(e){return{users:e.users}},Q)(P),Y=n(25),Z=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).addComment=function(e){e.preventDefault(),n.props.addComment(n.props.blogId,n.state.comment),n.setState({comment:""})},n.handleCommentChange=function(e){e.preventDefault(),n.setState({comment:e.target.value})},n.findBlog=function(){return n.props.blogs.find(function(e){return e._id===n.props.blogId})},n.state={userId:e.userId,comment:""},n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.initBlogs()}}]),Object(p.a)(t,[{key:"render",value:function(){var e=this.findBlog();return e?r.a.createElement("div",null,r.a.createElement("h2",null,e.title),r.a.createElement("div",null,r.a.createElement("a",{href:e.url},e.url)),r.a.createElement("div",null,"likes: ",e.likes),r.a.createElement("div",null,"added by ",e.user.name),r.a.createElement("div",null,"Comments:",r.a.createElement("div",null,r.a.createElement("form",{onSubmit:this.addComment},r.a.createElement("div",null,r.a.createElement("input",{value:this.state.comment,onChange:this.handleCommentChange})),r.a.createElement("button",null,"add comment"))),r.a.createElement("ul",null,e.comments.map(function(e,t){return r.a.createElement("li",{key:t},e)})))):""}}]),t}(r.a.Component),$=Object(c.b)(function(e){return{blogs:e.blogs}},function(e){return Object(Y.bindActionCreators)({initBlogs:B,addComment:U},e)})(Z),ee=function(e){function t(){return Object(m.a)(this,t),Object(f.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this.props.notification;return e?e.isError?r.a.createElement("div",{className:"errorMessage",style:{border:1,borderStyle:"solid",borderColor:"red",padding:15,width:"25em"}},e.message):r.a.createElement("div",{className:"successMessage",style:{border:1,borderStyle:"solid",borderColor:"green",padding:15,width:"25em"}},e.message):null}}]),t}(r.a.Component),te=Object(c.b)(function(e){return{notification:e.notification}},null)(ee),ne={login:function(){var e=Object(s.a)(i.a.mark(function e(t){var n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},ae=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"USER_LOGGED_IN"===t.type?t.data:"USER_LOGGED_OUT"===t.type?null:"USER_LOADED"===t.type?t.data:e},re=n(178),le=n(176),oe=n(177),ce=n(56),ue=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).handleLoginFieldChange=function(e){n.setState(Object(d.a)({},e.target.name,e.target.value))},n.login=function(){var e=Object(s.a)(i.a.mark(function e(t){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n.props.logIn({username:n.state.username,password:n.state.password});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.state={username:"",password:""},n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.initBlogs(),this.props.loadUserFromLocalStorage()}},{key:"render",value:function(){var e=this;return r.a.createElement(b.a,null,r.a.createElement("div",{className:"container"},r.a.createElement(te,null),!this.props.loggedInUser&&function(){var t={display:e.state.loginVisible?"none":""},n={display:e.state.loginVisible?"":"none"};return r.a.createElement("div",null,r.a.createElement("div",{style:t},r.a.createElement("button",{onClick:function(){return e.setState({loginVisible:!0})}},"log in")),r.a.createElement("div",{style:n},r.a.createElement(R,{username:e.state.username,password:e.state.password,handleChange:e.handleLoginFieldChange,handleSubmit:e.login}),r.a.createElement("button",{onClick:function(){return e.setState({loginVisible:!1})}},"cancel")))}(),this.props.loggedInUser&&r.a.createElement("div",null,r.a.createElement(re.a,{inverse:!0,collapseOnSelect:!0},r.a.createElement(re.a.Header,null,r.a.createElement(re.a.Brand,null,"blog app")),r.a.createElement(le.a,null,r.a.createElement(ce.LinkContainer,{to:"/"},r.a.createElement(oe.a,null,"blogs")),r.a.createElement(ce.LinkContainer,{to:"/users"},r.a.createElement(oe.a,null,"users")),r.a.createElement(oe.a,null,r.a.createElement("i",null,e.props.loggedInUser.name," logged in")),r.a.createElement(oe.a,null,r.a.createElement("button",{onClick:e.props.logOut},"logout"))))),r.a.createElement(v.a,{exact:!0,path:"/users",render:function(){return r.a.createElement("div",null,r.a.createElement(K,null))}}),r.a.createElement(v.a,{exact:!0,path:"/users/:id",render:function(e){var t=e.match;return r.a.createElement(X,{userId:t.params.id})}}),r.a.createElement(v.a,{exact:!0,path:"/blogs/:id",render:function(e){var t=e.match;return r.a.createElement($,{blogId:t.params.id})}}),r.a.createElement(v.a,{exact:!0,path:"/",render:function(){return e.props.loggedInUser&&r.a.createElement("div",null,r.a.createElement(M,null),e.props.blogs.map(function(e){return r.a.createElement(O,{key:e._id,blog:e})}))}})))}}]),t}(r.a.Component),ie={initBlogs:B,loadUserFromLocalStorage:function(){return function(e){var t=window.localStorage.getItem("loggedBlogappUser");if(t){var n=JSON.parse(t);S.setToken(n.token),e({type:"USER_LOADED",data:n})}}},logIn:function(e){return function(){var t=Object(s.a)(i.a.mark(function t(n){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne.login(e);case 3:a=t.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),S.setToken(a.token),n({type:"USER_LOGGED_IN",data:a}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),A(!0,"Invalid username or password")(n);case 12:case"end":return t.stop()}},t,this,[[0,9]])}));return function(e){return t.apply(this,arguments)}}()},logOut:function(){return function(e){window.localStorage.removeItem("loggedBlogappUser"),S.setToken(""),e({type:"USER_LOGGED_OUT"}),A(!1,"Logged out")(e)}}},se=Object(c.b)(function(e){return{blogs:e.blogs,loggedInUser:e.loggedInUser}},ie)(ue),de=n(91),me=n(92),pe=Object(Y.combineReducers)({users:z,blogs:_,loggedInUser:ae,notification:x}),fe=Object(Y.createStore)(pe,Object(me.composeWithDevTools)(Object(Y.applyMiddleware)(de.a))),he=function(){o.a.render(r.a.createElement(c.a,{store:fe},r.a.createElement(se,null)),document.getElementById("root"))};he(),fe.subscribe(he)},93:function(e,t,n){e.exports=n(171)}},[[93,2,1]]]);
//# sourceMappingURL=main.b6814993.chunk.js.map